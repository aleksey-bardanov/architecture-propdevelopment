# Задание 3. Внешние интеграции

## Взаимодействие между системами предприятия и сервисами умного дома:

### Пользовательские сценарии для системы Умный шлагбаум

- Подключение собственника к услуге. 
  - Собственник идентифицируется, проходит аутентификацию и авторизацию в системе через мобильное приложение
  - Собственник загружает регистрационный номер автомобиля (возможно несколько) в базу данных сервиса **tenant-smart-home-app**. Взаимодействие с внешними сервисами не требуется
- Въезд и выезд с территории ЖК. 
  - Устройство при подъезде автомобиля должно распознавать его регистрационный номер и передавать сервису **tenant-smart-home-app** запрос на открытие шлагбаума, содержащий номер авто и свой ID
  - Сервис **tenant-smart-home-app** принимает решение об открытии шлагбаума на основании имеющихся данных
  - Если разрешение подтверждено, решение без подробностей передается по цепочке обратно. Если решение положительное, то шлагбаум открывается, если нет - собственнику должно прийти уведомление об отказе с указанием причины отказа и дальнейшим порядком действий

### Пользовательские сценарии для системы Умный домофон

- Подключение собственника к услуге. 
  - Собственник идентифицируется, проходит аутентификацию и авторизацию в системе через мобильное приложение
  - Собственник загружает биометрию (возможно несколько) в базу данных сервиса **tenant-smart-home-app**. Взаимодействие с внешними сервисами не требуется
- Использование домофона 
  - Устройство при совершении звонка должно определить данные биометрии человека, пытающегося попасть в дом и передать их сервису **tenant-smart-home-app** вместе с номером квартиры в которую звонит человек, а также ID домофона
  - Сервис **tenant-smart-home-app** принимает решение об открытии двери на основании имеющихся данных
  - Если да - дверь открывается, если нет - собственнику выполняется видеозвонок и далее по сценарию работы обычного домофона

В рамках описанных взаимодействий между системой компании и внешними сервисами требуется передавать личные данные собственников (биометрию, номера квартир, номера автомобилей), ассоциированные с конкретными пользователями системы и в рамках определенных сессий при этом существует возможность:

- Перехвата идентификатора. Связанные угрозы: Identifier Guessing, ID Spoofing
- Сбора информации о собственниках. Связанные угрозы: Information Harvesting
- Перехвата данных сессий. Связанные угрозы: Session Hijacking, Man In A Middle

## Требования к безопасности внешних интеграций:

### Защита канала передачи данных:

- Все данные должны передаваться через зашифрованные каналы связи (HTTPS/TLS) или через VPN
- Применять флаги безопасности для куки (HttpOnly, Secure)
- Реализовать проверку целостности сообщений (например, с использованием цифровых подписей или HMAC) для предотвращения изменения данных при передаче

### Защита идентификаторов IoT устройств

- Шифрование или маскировка идентификаторов
- Использование UUID

### Дополнительные меры на стороне PropDevelopment:

- Обработка и хранение данных (биометрия и данные о номерах автомобилей) должна выполняться в соответствии со стандартами безопасности (например, 152-ФЗ)
- Внедрение системы мониторинга, логирования и аудита. В логах произвести обезличивание и шифрование данных
- Система должна поддерживать защиту от попыток подбора биометрии или автомобильных номеров
- Доступ к конфиденциальным данным должен быть ограничен только для авторизованных пользователей и систем

## Аутентификация и авторизация:

- Многофакторная аутентификация (MFA) для собственников
- Протокол OAuth 2.0 для авторизации и аутентификации собственников
- JWT для идентификации запросов к API
- Ролевая модель доступа (RBAC): собственники должны иметь ограниченный доступ к системе